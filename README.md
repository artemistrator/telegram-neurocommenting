# Telegram Monitor Web UI

Веб-интерфейс для мониторинга Telegram чатов с AI-фильтрацией и отправкой уведомлений в N8N.

## Возможности

*   **Web UI**: Удобный интерфейс на базе FastAPI и TailwindCSS для управления настройками.
*   **Telegram Auth**: Полная поддержка авторизации (включая 2FA/Cloud Password).
*   **Выбор чатов**: Просмотр списка доступных диалогов и выбор чатов для мониторинга.
*   **AI-фильтрация**: Интеграция с OpenAI (GPT-4o/GPT-5-nano) для анализа сообщений на релевантность (поиск вакансий, заказов).
*   **Гибкие триггеры**: Возможность использования ключевых слов вместе с AI или отдельно.
*   **Webhooks**: Отправка отфильтрованных сообщений в N8N или любую другую систему через вебхуки.
*   **Live Logs**: Просмотр событий мониторинга в реальном времени через Server-Sent Events (SSE).
*   **Стабильность**: Автоматический перезапуск мониторинга при разрыве соединения.

## Установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <repository-url>
    cd <repository-folder>
    ```

2.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **Запустите приложение:**
    ```bash
    python main.py
    ```
    Сервер запустится по адресу: `http://localhost:8000`

## Использование

1.  **Настройки Telegram**:
    *   Откройте веб-интерфейс.
    *   Введите `API ID`, `API Hash` (получить на [my.telegram.org](https://my.telegram.org)) и номер телефона.
    *   Нажмите "Сохранить настройки".

2.  **Авторизация**:
    *   Нажмите кнопку "Авторизоваться".
    *   Введите код из SMS/Telegram.
    *   Если установлен облачный пароль (2FA), введите его в появившемся окне.

3.  **Выбор чатов**:
    *   Нажмите "Получить список чатов".
    *   Отметьте галочками нужные чаты и каналы.
    *   Нажмите "Сохранить выбранные чаты".

4.  **Настройка фильтров**:
    *   Укажите URL вебхука (например, N8N workflow).
    *   Включите "Использовать AI фильтр" и введите API Key OpenAI.
    *   Настройте системный промпт и ключевые слова.

5.  **Запуск**:
    *   Нажмите "Запустить мониторинг".
    *   Следите за новыми сообщениями в панели "Последние события".

## Структура проекта

*   `main.py` — Основной файл приложения (FastAPI backend). Управляет веб-сервером, настройками и процессом мониторинга.
*   `monitor.py` — Скрипт мониторинга (запускается как подпроцесс). Подключается к Telegram, слушает сообщения, фильтрует их и отправляет вебхуки.
*   `index.html` — Главная страница веб-интерфейса.
*   `static/script.js` — Логика фронтенда (взаимодействие с API, обновление UI, SSE).
*   `config.json` — Файл конфигурации (создается автоматически).
*   `*.session` — Файлы сессий Telegram (не удаляйте их, чтобы сохранить авторизацию).

## Требования

*   Python 3.8+
*   Аккаунт Telegram
*   API Key OpenAI (опционально, для AI-фильтрации)